# =============================================================================
# Auto-generated by Network Security Policy-as-Code
# Policy: allow-web-to-api
# Ticket: SNOW-12345
# Requestor: john.smith@company.com
# Scope: subscription-prod
# =============================================================================

# Supporting Resources

data "azurerm_application_security_group" "web_tier" {
  name                = "asg-web-tier"
  resource_group_name = "rg-network-security"
}


data "azurerm_application_security_group" "api_tier" {
  name                = "asg-api-tier"
  resource_group_name = "rg-network-security"
}

# Policy Resources

resource "azurerm_network_security_rule" "allow_web_to_api_0_0" {
  name                        = "allow-web-to-api-0-0"
  priority                    = 100
  direction                   = "Inbound"
  access                      = "Allow"
  protocol                    = "Tcp"
  source_port_range          = "*"
  destination_port_range     = "443"
  
  source_application_security_group_ids = [data.azurerm_application_security_group.web_tier.id]
  
  destination_application_security_group_ids = [data.azurerm_application_security_group.api_tier.id]
  resource_group_name         = "TODO_RESOURCE_GROUP"  # Configure based on scope
  network_security_group_name = "TODO_NSG_NAME"  # Configure based on scope
  
  description = "Allow web tier to communicate with API tier on HTTPS - SNOW-12345"
}
